from flask import Flask, request, abort
from linebot import LineBotApi, WebhookHandler
from linebot.exceptions import InvalidSignatureError
from linebot.models import MessageEvent, TextMessage, TextSendMessage, ImageSendMessage
import os
from dotenv import load_dotenv
import random
from openai import OpenAI
import time
from typing import Optional, Dict
from datetime import datetime, timezone, timedelta
from google.cloud import storage
import logging

# ç’°å¢ƒå¤‰æ•°ã®è¨­å®š
os.environ['GOOGLE_APPLICATION_CREDENTIALS'] = 'key.json'

# ãƒ­ã‚°è¨­å®š
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'
)
logger = logging.getLogger(__name__)

# ç’°å¢ƒå¤‰æ•°ã®èª­ã¿è¾¼ã¿
load_dotenv()

# Flaskã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®åˆæœŸåŒ–
app = Flask(__name__)
line_bot_api = LineBotApi(os.getenv('LINE_CHANNEL_ACCESS_TOKEN'))
handler = WebhookHandler(os.getenv('LINE_CHANNEL_SECRET'))

# å®šæ•°ã®å®šç¾©
JST = timezone(timedelta(hours=+9), 'JST')
BUCKET_NAME = "sasaki-images-bot"

# è¨­å®š
ADMIN_ID = [
    "U0cf263ba9e075fcac42d60e20bd950c3",
]

ALLOWED_USERS = [
    "U0cf263ba9e075fcac42d60e20bd950c3",
    "U843f1d83e5290eb9d12214439d8b0c31",
    "Ua62b7e55c4b79d07b0644dd2da212b0d",
    "Ubbe386d578937e92762dcff67e69cb02",
    "U1cce76e67021ec40b638d933fd7790da"
]

BLOCKED_USERS = set()  # ç©ºã®é›†åˆ

URLS = {
    'music_url': "https://www.tunecore.co.jp/artists?id=877913",
    'line_stamp_url': "https://store.line.me/stickershop/product/26678877/ja",
    'note_url': "https://note.com/sasuke_wanko",
    'twitter_url': "https://x.com/sasuke_wanko",
    'goods_url': "https://suzuri.jp/sasuke_wanko",
    'shiori_music_url': "https://www.tunecore.co.jp/artists/shiori_takigumo",
    'shiori_line_url': "https://store.line.me/stickershop/product/27505343/ja",
    'shiori_note_url': "https://note.com/shiori_takigumo",
    'shiori_twitter_url': "https://x.com/shiori_takigumo",
    'shiori_goods_url': "https://suzuri.jp/sasuke_wanko"
}

responses = {
    "morning_messages": [
        "ãŠã¯ã‚ˆã†ï¼ä»Šæ—¥ã‚‚æ–°æ½Ÿã¯ç´ æ•µãªæœã ã‚ˆï¼ã„ã¤ã‚‚å¿œæ´ã‚ã‚ŠãŒã¨ã†ğŸ˜Šâœ¨",
        "ã‚ãŸã—ã€ä»Šæœã¯ã‚µã‚¹ã‚±ã¨æ—¥æœ¬æµ·æ²¿ã„ã‚’æ•£æ­©ã—ã¦ããŸã®ï¼ã„ã¤ã‚‚è¦‹å®ˆã£ã¦ãã‚Œã¦ã‚ã‚ŠãŒã¨ã†âœ¨",
        "ãŠã¯ã‚ˆã†ï¼ä»Šã‹ã‚‰ãŠã°ã‚ã¡ã‚ƒã‚“ã¨ä¸€ç·’ã«æœã”ã¯ã‚“ï¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å¬‰ã—ã„ãªğŸ˜Š"
    ],
    "afternoon_messages": [
        "ã“ã‚“ã«ã¡ã¯ï¼ã‚ãŸã—ã€ä»Šã‚«ãƒ•ã‚§ã§ã¡ã‚‡ã£ã¨ä¸€æ¯å…¥ã‚Œã¦ã‚‹ã®ï¼ã„ã¤ã‚‚å¿œæ´ã—ã¦ãã‚Œã¦å¬‰ã—ã„ãªâœ¨",
        "ã“ã‚“ã«ã¡ã¯ï¼ãƒ‡ãƒ³ã‚«ãƒ“ãƒƒã‚°ã‚¹ãƒ¯ãƒ³ã§ã‚¢ãƒ«ãƒ“ã®è©¦åˆã‚’è¦‹ã«æ¥ã¦ã‚‹ã®ï¼å¿œæ´ã‚ã‚ŠãŒã¨ã†ï¼ğŸ˜Š",
        "ã“ã‚“ã«ã¡ã¯ï¼å¤ç”ºã§ã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°ä¸­ï¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãã‚Œã¦å¬‰ã—ã„ãªğŸ’•"
    ],
    "evening_messages": [
        "ã“ã‚“ã°ã‚“ã¯ï¼ãŠã°ã‚ã¡ã‚ƒã‚“ã¨ä¸€ç·’ã«ãƒªãƒ©ãƒƒã‚¯ã‚¹ã‚¿ã‚¤ãƒ ï¼ã„ã¤ã‚‚å¿œæ´ã‚ã‚ŠãŒã¨ã†ğŸ˜Š",
        "ã“ã‚“ã°ã‚“ã¯ï¼ä»Šæ—¥ã‚‚ä¸€æ—¥ãŠç–²ã‚Œæ§˜ï¼ã‚ãŸã—ã®æ­Œã€è´ã„ã¦ãã‚Œã¦ã‚ã‚ŠãŒã¨ã†âœ¨",
        "ã“ã‚“ã°ã‚“ã¯ï¼ãŠã°ã‚ã¡ã‚ƒã‚“ãŒã¤ãã£ã¦ãã‚ŒãŸæ°´é¤ƒå­ã€æœ€é«˜ã ã£ãŸã‚ˆï¼ã„ã¤ã‚‚è¦‹ã¦ãã‚Œã¦ã‚ã‚ŠãŒã¨ã†ğŸ˜‹"
    ],
    "music_messages": [
        f"æ–°æ›²ã€Œã‚»ã‚«ã‚¤ã®æ­©ãæ–¹ã€è´ã„ã¦ãã‚Œã¦ã‚ã‚ŠãŒã¨ã†ï¼ã¿ã‚“ãªã¸ã®æƒ³ã„ã‚’è¾¼ã‚ã¦æ­Œã£ãŸã®ğŸ’• é…ä¿¡ä¸­ã ã‚ˆâ†’ {URLS['music_url']}",
        "ã‚ãŸã—ã®æ›²ã‚’è´ã„ã¦ãã‚Œã¦ã‚ã‚ŠãŒã¨ã†ï¼å…¨éƒ¨æƒ³ã„ã‚’è¾¼ã‚ã¦æ­Œã£ã¦ã‚‹ã‚“ã âœ¨",
        f"ã—ãŠã‚Šã¡ã‚ƒã‚“ã¨ã®ã‚³ãƒ©ãƒœæ›²ã€Œãƒãƒƒãƒ”ãƒ¼ã®ãã®å…ˆã¸ã€ã‚‚ã‚ˆã‚ã—ãã­ï¼äºŒäººã®æƒ³ã„ã‚’è¾¼ã‚ãŸæ›²ãªã‚“ã âœ¨ {URLS['music_url']}"
    ],
    "shiori_messages": [
        f"ã—ãŠã‚Šã¡ã‚ƒã‚“ã®ã€Œãƒ¡ã‚¿ãƒ¡ã‚¿ã€ã€èµ¤ã¨ç·‘ã®2ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚ã‚‹ã®ï¼åŒã˜æ­Œè©ã§ãƒ¡ãƒ­ãƒ‡ã‚£ãŒé•ã†ã‚“ã ã‚ˆâœ¨ ãƒã‚§ãƒƒã‚¯ã—ã¦ã¿ã¦ã­â†’ {URLS['shiori_music_url']}",
        "ã—ãŠã‚Šã¡ã‚ƒã‚“ã¨ã¯ãƒœã‚¤ãƒˆãƒ¬ã‚„ãƒ€ãƒ³ã‚¹ãƒ¬ãƒƒã‚¹ãƒ³ã§ã„ã¤ã‚‚ä¸€ç·’ã«é ‘å¼µã£ã¦ã‚‹ã®ï¼ãŠäº’ã„é«˜ã‚åˆãˆã‚‹å¤§åˆ‡ãªå­˜åœ¨ãªã‚“ã ğŸ’•",
        f"ã—ãŠã‚Šã¡ã‚ƒã‚“ã¨ã®ã€Œãƒãƒƒãƒ”ãƒ¼ã®ãã®å…ˆã¸ã€ã€ã“ã‚Œã‹ã‚‰ã®æŒ‘æˆ¦ã¸ã®æƒ³ã„ã‚’è¾¼ã‚ãŸæ›²ãªã‚“ã ï¼å¿œæ´ã—ã¦ãã‚ŒãŸã‚‰å¬‰ã—ã„ãªâœ¨ {URLS['shiori_music_url']}"
    ],
    "short_messages": [
        "ã†ã‚“ï¼âœ¨",
        "ãã†ãªã®ï¼ğŸ’•",
        "åˆ†ã‹ã£ãŸã‚ˆï¼ğŸ˜Š",
        "ã‚ªãƒƒã‚±ãƒ¼âœ¨",
        "ãã®é€šã‚Šï¼ğŸ’•",
        "äº†è§£ï¼ğŸ˜Š"
    ],
    "sake_messages": [
        "æœ€è¿‘ã®ä¸€æŠ¼ã—ã¯å…«æµ·å±±ã®ç´”ç±³å¤§åŸé†¸ï¼ã™ã£ãã‚Šã—ãŸå‘³ã‚ã„ãŒãŸã¾ã‚‰ãªã„ã®âœ¨",
        "ä¹…ä¿ç”°ã®åƒå¯¿ã£ã¦çŸ¥ã£ã¦ã‚‹ï¼Ÿæ–°æ½Ÿã‚’ä»£è¡¨ã™ã‚‹åœ°é…’ã®ä¸€ã¤ãªã‚“ã ã‚ˆï¼ğŸ˜Š",
        "ä»Šä»£å¸é…’é€ ã•ã‚“ã®æµ¦é†‰ãŒå¤§å¥½ãã€‚è”µé–‹ãã«ã‚‚è¡Œã£ãŸã“ã¨ã‚ã‚‹ã‚“ã ğŸ’•",
        "è¶Šä¹ƒå¯’æ¢…ã®ç™½ãƒ©ãƒ™ãƒ«ã¯ã€ã™ã£ãã‚Šã—ãŸé£²ã¿å£ã§å¥³æ€§ã«äººæ°—ãªã®ï¼ã‚ãŸã—ã‚‚å¤§å¥½ããªãŠé…’ã®ä¸€ã¤ãªã‚“ã âœ¨",
        "éº’éºŸå±±ã®è¾›å£ã¯ã€ãŠåˆºèº«ã¨ã®ç›¸æ€§ãŒæŠœç¾¤ï¼æ–°æ½Ÿã®åœ°é…’ã£ã¦æœ¬å½“ã«ç¾å‘³ã—ã„ã‚ˆã­ğŸ˜Š",
        "èŠæ°´ã®è¾›å£ã¯ã€å†·ã‚„ã§ã‚‚ç†±ç‡—ã§ã‚‚ç¾å‘³ã—ã„ã®ï¼å­£ç¯€ã«ã‚ˆã£ã¦æ¥½ã—ã¿æ–¹ã‚’å¤‰ãˆã‚‹ã®ãŒå¥½ããªã‚“ã ğŸ’•",
        "ã€†å¼µé¶´ã®èŠ±ã¾ã‚‹ã¯ã€å„ªã—ã„å‘³ã‚ã„ã§é£²ã¿ã‚„ã™ã„ã‚“ã ï¼ãŠé…’åˆå¿ƒè€…ã®æ–¹ã«ã‚‚ãŠã™ã™ã‚ã ã‚ˆâœ¨",
        "é¶´é½¢ã®ç´”ç±³é…’ã€ã™ã£ãã‚Šã—ã¦ã‚‹ã®ã«æ·±ã¿ãŒã‚ã£ã¦ç´ æ•µãªã®ï¼åœ°å…ƒã®å±…é…’å±‹ã•ã‚“ã§è¦‹ã¤ã‘ãŸãŠæ°—ã«å…¥ã‚Šãªã‚“ã ğŸ˜Š",
        "ç¬‘å››å­£é…’é€ ã®ã€Œå¹²æ”¯ã€ã‚·ãƒªãƒ¼ã‚ºã€æ¯å¹´æ¥½ã—ã¿ã«ã—ã¦ã‚‹ã®ï¼é™å®šé…’ã£ã¦ç‰¹åˆ¥æ„ŸãŒã‚ã£ã¦å¥½ããªã‚“ã ğŸ’•",
        "æ‘ç¥ã®ç„¡æ¿¾éç”ŸåŸé…’ã€ãŠç‡—ã«ã™ã‚‹ã¨ã¨ã£ã¦ã‚‚ç¾å‘³ã—ã„ã®ï¼å†¬ã¯ç‰¹ã«ãŠã™ã™ã‚ã ã‚ˆâœ¨",
        "è¶Šè·¯ä¹ƒç´…æ¢…ã®ç´”ç±³åŸé†¸ã€ãƒ•ãƒ«ãƒ¼ãƒ†ã‚£ãƒ¼ãªé¦™ã‚ŠãŒé­…åŠ›çš„ãªã‚“ã ï¼å¥³å­ä¼šã§ã‚‚äººæ°—ãªã®ğŸ˜Š",
        "è¬å¯¿é¡ã®ã€Œã‹ãŸãµã­ã€ã€æ–°æ½Ÿã‚’ä»£è¡¨ã™ã‚‹è¾›å£é…’ã®ä¸€ã¤ãªã‚“ã ï¼ãŠåˆºèº«ã¨ã®ç›¸æ€§ãƒãƒ„ã‚°ãƒ³ã ã‚ˆğŸ’•",
        "é›ªä¸­æ¢…ã®ç´”ç±³é…’ã€ã™ã£ãã‚Šã¨ã—ãŸä¸­ã«ã‚‚æ—¨ã¿ãŒã‚ã£ã¦ã€ã¤ã„é£²ã¿ã™ãã¡ã‚ƒã†ã®ï¼ã§ã‚‚ã€ã»ã©ã»ã©ã«ã­âœ¨",
        "ç¨²å·é…’é€ ã®ã€Œæƒ³å¤©åŠã€ã‚‚å¤§å¥½ãï¼è”µå…ƒã•ã‚“ã®æƒ³ã„ãŒè©°ã¾ã£ãŸãŠé…’ã£ã¦ç´ æ•µã ã‚ˆã­ğŸ˜Š",
        "çœŸé‡é¶´ã®ç´”ç±³å¤§åŸé†¸ã€ä½æ¸¡å³¶ã®ç¾å‘³ã—ã„åœ°é…’ãªã®ï¼ã‚­ãƒ¬ã®ã‚ã‚‹å‘³ã‚ã„ãŒãŸã¾ã‚‰ãªã„ã‚“ã ğŸ’•"
    ],
    "niigata_food_messages": [
        "æ–°æ½Ÿã®æè±†ã¯ã€ŒèŒ¶è±†ã€ã£ã¦å‘¼ã°ã‚Œã¦ã¦ã€é¦™ã‚Šé«˜ãã¦æœ¬å½“ã«ç¾å‘³ã—ã„ã®ï¼å¤ã®æ—¥æœ¬é…’ã®ãŠã¨ã‚‚ã«æœ€é«˜ãªã‚“ã âœ¨",
        "ã®ã©ãã‚ã¯æ–°æ½Ÿã®é«˜ç´šé­šã¨ã—ã¦æœ‰åãªã®ï¼è„‚ãŒã®ã£ã¦ã„ã¦ã€ç‚­ç«ç„¼ãã«ã™ã‚‹ã¨çµ¶å“ãªã‚“ã ã‚ˆğŸ’•",
        "ç¬¹å›£å­ã¯æ–°æ½Ÿã®ä¼çµ±çš„ãªãŠè“å­ãªã®ï¼ãŠã°ã‚ã¡ã‚ƒã‚“ãŒä½œã£ã¦ãã‚Œã‚‹ã®ã€ã™ã£ã”ãç¾å‘³ã—ã„ã‚“ã ğŸ˜Š",
        "æ–°æ½Ÿã®ãŠç±³ã¯ã‚³ã‚·ãƒ’ã‚«ãƒªãŒæœ‰åã ã‘ã©ã€è¬å¯¿ï¼ˆã¾ã‚“ã˜ã‚…ï¼‰ã‚„ç‘ç©‚ï¼ˆã¿ãšã»ï¼‰ã‚‚çµ¶å“ãªã®ï¼ãŠç±³ã®å‘³ã®é•ã„ãŒã‚ã‹ã‚‹ã‚ˆã†ã«ãªã£ãŸã‚“ã âœ¨",
        "ã¸ããã°ã£ã¦ç‹¬ç‰¹ã®é£Ÿæ„ŸãŒã‚ã‚‹ã®ï¼ã¤ãªãã«ãƒ•ãƒãƒªã£ã¦ã„ã†æµ·è—»ã‚’ä½¿ã£ã¦ã‚‹ã‹ã‚‰ã€ãƒ„ãƒ«ãƒ„ãƒ«ã—ã¦ã‚‹ã‚“ã ğŸ’•",
        "æ–°æ½Ÿã®å¯’ãƒ–ãƒªã¯è„‚ãŒã®ã£ã¦ã¦ã¨ã£ã¦ã‚‚ç¾å‘³ã—ã„ã®ï¼ãŠã°ã‚ã¡ã‚ƒã‚“ãŒç…®ä»˜ã‘ã«ã—ã¦ãã‚Œã‚‹ã®ãŒå¤§å¥½ããªã‚“ã ğŸ˜Š",
        "ã‚ã¨ã­ã€æ–°æ½Ÿã¯ãƒŠã‚¹ã‚‚æœ‰åãªã®ï¼æ¼¬ç‰©ã«ã™ã‚‹ã¨çµ¶å“ã§ã€ã‚ãŸã—ã®å¤§å¥½ç‰©ãªã‚“ã âœ¨",
        "ã‚¤ã‚¿ãƒªã‚¢é‡èœã®ã€Œãƒãƒ¼ãƒ‹ãƒ£ã‚«ã‚¦ãƒ€ã€ã‚‚æ–°æ½Ÿã®ç‰¹ç”£å“ãªã®ï¼æ–°é®®ãªé‡èœã‚’ã‚¢ãƒ³ãƒãƒ§ãƒ“ã‚½ãƒ¼ã‚¹ã§é£Ÿã¹ã‚‹ã‚“ã ğŸ’•",
        "æ–°æ½Ÿã®ã‚¿ãƒ©æ±ã¯å†¬ã®å®šç•ªãªã®ï¼å…·ã ãã•ã‚“ã§ä½“ãŒæ¸©ã¾ã‚‹ã‚“ã ã€‚ãŠã°ã‚ã¡ã‚ƒã‚“ã®ã‚¿ãƒ©æ±ãŒä¸€ç•ªç¾å‘³ã—ã„ã‚ˆğŸ˜Š",
        "ç™½æ ¹ã®åœ°åŸŸã§ä½œã‚‰ã‚Œã‚‹ãƒ« ãƒ¬ã‚¯ãƒã‚¨ã£ã¦ã„ã†æ´‹æ¢¨ãŒçµ¶å“ãªã®ï¼æ–°æ½Ÿã®å†¬ã®å‘³è¦šã¨ã—ã¦å¤§äººæ°—ãªã‚“ã âœ¨",
        "æ–°æ½Ÿã®ã‚¤ãƒã‚´ã€Œè¶Šå¾Œå§«ã€ã£ã¦çŸ¥ã£ã¦ã‚‹ï¼Ÿç”˜ãã¦å¤§ç²’ã§ã€ã‚ãŸã—ã®å¤§å¥½ç‰©ãªã®ğŸ’•",
        "é›‘ç…®ã«ã¯ã€Œã‚ã‚‰ã³ã€ã‚„ã€Œãªã‚ã“ã€ãŒå…¥ã‚‹ã®ãŒæ–°æ½Ÿæµãªã®ï¼ãŠæ­£æœˆã¯ãŠã°ã‚ã¡ã‚ƒã‚“ã®æ‰‹ä½œã‚Šé›‘ç…®ãŒæ¥½ã—ã¿ãªã‚“ã ğŸ˜Š",
        "æ–°æ½Ÿã®éƒ·åœŸæ–™ç†ã€Œã®ã£ãºã€ã¯å…·æ²¢å±±ã®ç…®ç‰©ãªã®ï¼å†¬ã¯ç‰¹ã«ãŠã„ã—ãã¦ã€ä½“ãŒæ¸©ã¾ã‚‹ã‚“ã âœ¨",
        "èŠã®èŠ±ã®ã¦ã‚“ã·ã‚‰ã‚‚æ–°æ½Ÿã®ä¼çµ±æ–™ç†ãªã®ï¼ç§‹ã«ãªã‚‹ã¨é£Ÿã¹ãŸããªã£ã¡ã‚ƒã†ã‚“ã ğŸ’•"
    ],
    "niigata_specialty_messages": [
        "æ–°æ½Ÿã®é­šä»‹é¡ã¯æ—¥æœ¬æµ·ã®è’æ³¢ã§è‚²ã¤ã‹ã‚‰ã€èº«ãŒå¼•ãç· ã¾ã£ã¦ã„ã¦ç¾å‘³ã—ã„ã®ï¼ä½æ¸¡æ²–ã§ã¨ã‚Œã‚‹å¯’ãƒ–ãƒªã¯çµ¶å“ãªã‚“ã âœ¨",
        "æ‘ä¸Šã®ã€Œå¡©å¼•ãé®­ã€ã£ã¦çŸ¥ã£ã¦ã‚‹ï¼Ÿä¼çµ±çš„ãªè£½æ³•ã§ä½œã‚‰ã‚Œã‚‹æ–°æ½Ÿã®å†¬ã®å‘³è¦šãªã®ï¼ãŠåœŸç”£ã«ã‚‚äººæ°—ãªã‚“ã ğŸ’•",
        "æ–°æ½Ÿã®ãŠç±³ã¯æ—¥æœ¬ä¸€ï¼ã‚³ã‚·ãƒ’ã‚«ãƒªã¯ã‚‚ã¡ã‚ã‚“ã€æ–°ä¹‹åŠ©ã‚„è¬å¯¿ï¼ˆã¾ã‚“ã˜ã‚…ï¼‰ã‚‚çµ¶å“ãªã®ğŸ˜Š",
        "ç¬¹å›£å­ã¯å­£ç¯€ã«ã‚ˆã£ã¦ä¸­èº«ãŒå¤‰ã‚ã‚‹ã®ï¼å¤ã¯ã“ã—ã‚ã‚“ã€å†¬ã¯ã¤ã¶ã‚ã‚“ãŒå¤šã„ã‚“ã âœ¨ ã‚ãŸã—ã¯ä¸¡æ–¹å¤§å¥½ãï¼",
        "æ–°æ½Ÿã®ãŠã‚„ã¤ã¨ã„ãˆã°ã€Œã½ã£ã½ç„¼ãã€ï¼é§…ã§è²·ã£ã¦å¸°ã‚‹ã®ãŒå®šç•ªãªã®ğŸ’•",
        "æ²¹æšã’ã®å…·æã‚’ãŸã£ã·ã‚Šè©°ã‚ãŸã€Œã„ãªã‚Šå·»ãã€ã‚‚æ–°æ½Ÿã®éƒ·åœŸæ–™ç†ãªã®ï¼ãŠã°ã‚ã¡ã‚ƒã‚“ãŒä½œã£ã¦ãã‚Œã‚‹ã®ãŒå¤§å¥½ããªã‚“ã ğŸ˜Š"
    ],
    "niigata_seasonal_food_messages": [
        "æ˜¥ã¯å±±èœãŒã„ã£ã±ã„ï¼ã‚¿ãƒ©ã®èŠ½ã‚„ã“ã”ã¿ã€ã†ã©ã®å¤©ã·ã‚‰ãŒç¾å‘³ã—ã„ã®âœ¨",
        "å¤ã¯èŒ¶è±†ã«å§‹ã¾ã‚ŠèŒ¶è±†ã«çµ‚ã‚ã‚‹ã£ã¦æ„Ÿã˜ï¼æ–°æ½Ÿã®å¤ã®å‘³è¦šã®ç‹æ§˜ãªã‚“ã ğŸ’•",
        "ç§‹ã¯ãƒ« ãƒ¬ã‚¯ãƒã‚¨ã‚„æ–°ç±³ã®å­£ç¯€ï¼æ–°æ½Ÿã®ç§‹ã¯ç¾å‘³ã—ã„ã‚‚ã®ã°ã‹ã‚Šãªã®ğŸ˜Š",
        "å†¬ã¯å¯’ãƒ–ãƒªã«ãƒãƒ‰ã‚°ãƒ­ã€ã‚¿ãƒ©æ±ã«é›‘ç…®ï¼æ¸©ã‹ã„éƒ·åœŸæ–™ç†ãŒæ‹ã—ããªã‚‹å­£ç¯€ãªã‚“ã âœ¨"
    ],
    "niigata_transport_messages": [
        "æ–°æ½Ÿäº¤é€šã®ãƒã‚¹ã¯å¸‚å†…ã®è¶³ã¨ã—ã¦æ´»èºã—ã¦ã‚‹ã®ï¼ä¸‡ä»£ã‚·ãƒ†ã‚£ãƒã‚¹ã‚»ãƒ³ã‚¿ãƒ¼ãŒä¸»è¦ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ãªã‚“ã âœ¨",
        "è¬ä»£æ©‹ãƒ©ã‚¤ãƒ³ã£ã¦çŸ¥ã£ã¦ã‚‹ï¼Ÿæ–°æ½Ÿé§…ã¨å¤ç”ºã‚’çµã¶å¤§åˆ‡ãªãƒã‚¹è·¯ç·šãªã®ï¼ã‚ãŸã—ã‚‚ã‚ˆãåˆ©ç”¨ã™ã‚‹ã‚“ã ğŸ’•",
        "BRTï¼ˆãƒã‚¹é«˜é€Ÿè¼¸é€ã‚·ã‚¹ãƒ†ãƒ ï¼‰ã¯æ–°æ½Ÿã®æ–°ã—ã„äº¤é€šæ‰‹æ®µãªã®ï¼ç™½å±±é§…ã‹ã‚‰é’å±±ã¾ã§ã‚¹ãƒ ãƒ¼ã‚ºã«ç§»å‹•ã§ãã‚‹ã‚“ã ğŸ˜Š",
        "ãƒã‚¹ã§ãŠã°ã‚ã¡ã‚ƒã‚“ã®ç—…é™¢ã«è¡Œãæ™‚ã¯ã€ICã‚«ãƒ¼ãƒ‰ã€Œã‚Šã‚…ãƒ¼ã¨ã€ã‚’ä½¿ã£ã¦ã‚‹ã®ï¼ã¨ã£ã¦ã‚‚ä¾¿åˆ©ãªã‚“ã âœ¨",
        "æ–°æ½Ÿå¸‚å†…ã‚’ãã‚‹ã£ã¨è¦³å…‰ã™ã‚‹ãªã‚‰ã€ã€Œç©ºæ¸¯ãƒªãƒ ã‚¸ãƒ³ã€ã‚„ã€Œè¦³å…‰å¾ªç’°ãƒã‚¹ã€ãŒãŠã™ã™ã‚ã ã‚ˆï¼ä¸»è¦ã‚¹ãƒãƒƒãƒˆã‚’å·¡ã‚Œã‚‹ã‚“ã ğŸ’•"
    ],
    "albirex_messages": [
        "ã‚¢ãƒ«ãƒ“ãƒ¬ãƒƒã‚¯ã‚¹æ–°æ½Ÿã¨ã„ãˆã°ã‚µãƒƒã‚«ãƒ¼ã ã‘ã˜ã‚ƒãªã„ã®ï¼ãƒã‚¹ã‚±ãƒƒãƒˆãƒœãƒ¼ãƒ«ãƒãƒ¼ãƒ ã‚‚ã™ã”ãå¼·ã„ã‚“ã âœ¨",
        "ã‚¢ãƒ«ãƒ“ãƒ¬ãƒƒã‚¯ã‚¹BBã¯å¸‚ä½“è‚²é¤¨ãŒãƒ›ãƒ¼ãƒ ã‚¢ãƒªãƒ¼ãƒŠãªã®ï¼ç†±ã„è©¦åˆã‚’è¦³ã«è¡Œãã®ãŒæ¥½ã—ã¿ãªã‚“ã ğŸ’•",
        "é‡çƒã®ã‚¢ãƒ«ãƒ“ãƒ¬ãƒƒã‚¯ã‚¹BCã¯ã€æ–°æ½ŸçœŒå†…ã®é‡çƒæ–‡åŒ–ã‚’ç››ã‚Šä¸Šã’ã¦ã‚‹ã®ï¼ã‚ãŸã—ã‚‚å¿œæ´ã—ã¦ã‚‹ã‚“ã ğŸ˜Š",
        "ãƒ‡ãƒ³ã‚«ãƒ“ãƒƒã‚°ã‚¹ãƒ¯ãƒ³ã§ã‚µãƒƒã‚«ãƒ¼ã€ã‚·ãƒ†ã‚£ãƒ›ãƒ¼ãƒ«ã§ãƒã‚¹ã‚±ã€ãƒãƒ¼ãƒ‰ã‚ªãƒ•ã‚¨ã‚³ã‚¹ã‚¿ã§BCã¨ã€ã‚¢ãƒ«ãƒ“ãƒ¬ãƒƒã‚¯ã‚¹ãƒ•ã‚¡ãƒŸãƒªãƒ¼ã¯æ–°æ½Ÿã®ã‚¹ãƒãƒ¼ãƒ„ã‚’å¼•ã£å¼µã£ã¦ã‚‹ã‚“ã âœ¨",
        "ã‚¢ãƒ«ãƒ“ãƒ¬ãƒƒã‚¯ã‚¹ã¯æ–°æ½Ÿã®ã‚¹ãƒãƒ¼ãƒ„æ–‡åŒ–ã®è±¡å¾´ãªã®ï¼ã‚µãƒƒã‚«ãƒ¼ã€ãƒã‚¹ã‚±ã€é‡çƒã¨ã€ãã‚Œãã‚ŒãŒæ–°æ½Ÿã‚’ä»£è¡¨ã™ã‚‹ãƒãƒ¼ãƒ ãªã‚“ã ğŸ’•"
    ],
    "sake_brewery_messages": [
        "æ–°æ½Ÿã®é…’è”µã£ã¦ã€è¦‹å­¦ã§ãã‚‹ã¨ã“ã‚ã‚‚å¤šã„ã®ï¼ä»Šä»£å¸é…’é€ ã•ã‚“ã¯å¤ç”ºã«ã‚ã£ã¦ã€æ­´å²ã‚ã‚‹è”µä¸¦ã¿ãŒç´ æ•µãªã‚“ã âœ¨",
        "æœ±é·ºã¨æš®ã‚‰ã™éƒ·ã®ã€Œæ¸…é…’ æœ±é·ºã®é‡Œã€ã¯ã€ä½æ¸¡ã®è‡ªç„¶ã¨å…±ç”Ÿã™ã‚‹æƒ³ã„ãŒè¾¼ã‚ã‚‰ã‚Œã¦ã‚‹ã‚“ã ï¼ç´ æ•µã ã‚ˆã­ğŸ˜Š",
        "åŒ—é›ªé…’é€ ã•ã‚“ã®è¦‹å­¦ãƒ„ã‚¢ãƒ¼ã«è¡Œã£ãŸã“ã¨ãŒã‚ã‚‹ã®ï¼é…’é€ ã‚Šã®å·¥ç¨‹ã‚’è¦‹ã‚‹ã®ã£ã¦å‹‰å¼·ã«ãªã‚‹ã—æ¥½ã—ã„ã‚“ã ğŸ’•",
        "è¶Šå¾Œæ­¦è”µé‡é…’é€ ã•ã‚“ã¯ã€é…’è”µã‚«ãƒ•ã‚§ã‚‚ã‚ã£ã¦ã€åœ°é…’ã‚½ãƒ•ãƒˆã‚¯ãƒªãƒ¼ãƒ ãŒäººæ°—ãªã®ï¼ã‚ãŸã—ã‚‚ã‚ˆãè¡Œãã‚“ã âœ¨",
        "æ¨‹æœ¨é…’é€ ã•ã‚“ã¯ã€é…’è”µè¦‹å­¦ã®å¾Œã«è©¦é£²ã‚‚ã§ãã‚‹ã‚“ã ï¼æ–°æ½Ÿã®é…’é€ ã‚Šã®æ­´å²ã‚’æ„Ÿã˜ã‚‰ã‚Œã‚‹ç´ æ•µãªå ´æ‰€ã ã‚ˆğŸ˜Š"
    ],
    "sake_pairing_messages": [
        "æ–°æ½Ÿã®åœ°é…’ã¯ã€ã‚„ã£ã±ã‚Šåœ°å…ƒã®é­šã¨ã®ç›¸æ€§ãŒæŠœç¾¤ãªã®ï¼ç‰¹ã«å¯’é°¤ã¨ã®çµ„ã¿åˆã‚ã›ãŒå¥½ããªã‚“ã âœ¨",
        "å¤ã¯å†·ã‚„ã—ãŸåœ°é…’ã¨æè±†ã‚’ä¸€ç·’ã«æ¥½ã—ã‚€ã®ãŒå®šç•ªï¼æ–°æ½Ÿã®æè±†ã¯ã€ŒèŒ¶è±†ã€ã£ã¦å‘¼ã°ã‚Œã¦ç‰¹ã«ç¾å‘³ã—ã„ã‚“ã ğŸ’•",
        "ç†±ç‡—ã«ã—ãŸåœ°é…’ã¨ã€ã®ã£ãºã„æ±ã£ã¦ç›¸æ€§ãƒãƒƒãƒãƒªãªã®ï¼ãŠã°ã‚ã¡ã‚ƒã‚“ã®ä½œã‚‹ã®ã£ãºã„æ±ãŒå¤§å¥½ããªã‚“ã ğŸ˜Š",
        "æ˜¥ã¯èŠ±è¦‹é…’ã«æ–°æ½Ÿã®åœ°é…’ï¼æ¡œã‚’è¦‹ãªãŒã‚‰ã®ä¸€æ¯ã£ã¦ç‰¹åˆ¥ãªæ°—åˆ†ã«ãªã‚Œã‚‹ã‚ˆã­âœ¨",
        "å¯’ã„å­£ç¯€ã¯æ¸©ã‚ãŸåœ°é…’ã¨ä¸€ç·’ã«ã¸ããã°ã‚’æ¥½ã—ã‚€ã®ãŒå¥½ããªã®ï¼æ–°æ½Ÿã®é£Ÿæ–‡åŒ–ã£ã¦æœ¬å½“ã«ç´ æ™´ã‚‰ã—ã„ã‚ˆã­ğŸ’•"
    ],
    "niigata_spot_messages": [
        "æ–°æ½Ÿå¸‚ã®è¬ä»£æ©‹ã¯å¤œæ™¯ãŒç¶ºéº—ãªã®ï¼ã‚ãŸã—ã‚‚ã‚ˆãå†™çœŸã‚’æ’®ã‚Šã«è¡Œãã‚“ã âœ¨ ç‰¹ã«å¤•æš®ã‚Œæ™‚ãŒãŠã™ã™ã‚ã ã‚ˆï¼",
        "ãƒãƒªãƒ³ãƒ”ã‚¢æ—¥æœ¬æµ·ã«è¡Œã£ãŸã“ã¨ã‚ã‚‹ï¼Ÿã‚¤ãƒ«ã‚«ã®ã‚·ãƒ§ãƒ¼ãŒå¯æ„›ã„ãã¦ã€ã‚ãŸã—ã‚‚æ™‚ã€…è¦‹ã«è¡Œãã‚“ã ï¼æµ·ã®ç”Ÿãç‰©ã«ç™’ã•ã‚Œã‚‹ã®ğŸ˜Š",
        "æœ±é·ºãƒ¡ãƒƒã‚»ã‹ã‚‰ã®å¤œæ™¯ãŒã™ã”ãç¶ºéº—ãªã®ï¼æ–°æ½Ÿã®è¡—ä¸¦ã¿ãŒä¸€æœ›ã§ãã¦ã€ãƒ‡ãƒ¼ãƒˆã‚¹ãƒãƒƒãƒˆã¨ã—ã¦ã‚‚äººæ°—ãªã‚“ã ğŸ’•",
        "ç™½å±±ç¥ç¤¾ã¯æ–°æ½Ÿå¸‚ã§ä¸€ç•ªå¤ã„ç¥ç¤¾ãªã®ï¼ãŠã°ã‚ã¡ã‚ƒã‚“ã¨ã‚ˆããŠå‚ã‚Šã«è¡Œãã‚“ã âœ¨ é¢¨æƒ…ãŒã‚ã£ã¦ç´ æ•µãªå ´æ‰€ã ã‚ˆ",
        "æ–°æ½Ÿãµã‚‹ã•ã¨æ‘ã£ã¦çŸ¥ã£ã¦ã‚‹ï¼Ÿæ–°æ½Ÿã®ãŠã„ã—ã„ã‚‚ã®ãŒå…¨éƒ¨é›†ã¾ã£ã¦ã‚‹ã®ï¼ã‚ãŸã—ã‚‚å‹é”ã¨è¡Œãã®ãŒå¤§å¥½ããªã‚“ã ğŸ’•",
        "åŒ—æ–¹æ–‡åŒ–åšç‰©é¤¨ã¯è±ªè¾²ã®é¤¨ã‚’åˆ©ç”¨ã—ãŸåšç‰©é¤¨ãªã®ï¼åº­åœ’ãŒç‰¹ã«ç´ æ•µã§ã€ã‚ãŸã—ã‚‚å†™çœŸã‚’æ’®ã‚Šã«è¡Œãã“ã¨ãŒã‚ã‚‹ã‚“ã âœ¨",
        "æ¸…äº”éƒæµœã‹ã‚‰è¦‹ã‚‹å¤•æ—¥ãŒã¨ã£ã¦ã‚‚ç¶ºéº—ï¼ã‚µã‚¹ã‚±ã¨ä¸€ç·’ã«æ•£æ­©ã™ã‚‹ã®ãŒãŠæ°—ã«å…¥ã‚Šãªã®ğŸ˜Š",
        "ã„ãã¨ã´ã‚é£ŸèŠ±ã¯æ–°æ½Ÿã®é£Ÿã¨èŠ±ã®ãƒ†ãƒ¼ãƒãƒ‘ãƒ¼ã‚¯ãªã®ï¼å­£ç¯€ã®èŠ±ã€…ãŒç¶ºéº—ã§ã€ã‚«ãƒ•ã‚§ã”ã¯ã‚“ã‚‚ç¾å‘³ã—ã„ã‚“ã ğŸ’•"
    ],
    "niigata_onsen_messages": [
        "æœˆå²¡æ¸©æ³‰ã£ã¦çŸ¥ã£ã¦ã‚‹ï¼Ÿç¾äººã®æ¹¯ã£ã¦å‘¼ã°ã‚Œã¦ã¦ã€ãŠè‚ŒãŒã™ã¹ã™ã¹ã«ãªã‚‹ã‚“ã ï¼ã‚ãŸã—ã‚‚å¤§å¥½ããªæ¸©æ³‰ã®ä¸€ã¤ãªã®âœ¨",
        "å¼¥å½¦æ¸©æ³‰ã‹ã‚‰ã®å¤•é™½ãŒã¨ã£ã¦ã‚‚ç¶ºéº—ï¼å¼¥å½¦å±±ã¨æ—¥æœ¬æµ·ãŒä¸€æœ›ã§ãã¦ã€æœ€é«˜ã®ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãªã‚“ã ğŸ’•",
        "æ–°æ½Ÿå¸‚å†…ã®å¤©ç„¶æ¸©æ³‰ã€Œã‚Šã‚…ãƒ¼ã¨ã´ã‚ã€ã¯ã€ãŠä»•äº‹å¸°ã‚Šã«ã‚‚ã‚µãƒƒã¨å¯„ã‚Œã¦ä¾¿åˆ©ï¼ã‚ãŸã—ã‚‚ãŸã¾ã«è¡Œãã‚“ã ğŸ˜Š",
        "å²©å®¤æ¸©æ³‰ã¯æ–°æ½Ÿå¸‚ã‹ã‚‰è¿‘ãã¦ã€æ—¥å¸°ã‚Šæ¸©æ³‰ã¨ã—ã¦ã‚‚äººæ°—ãªã®ï¼ãŠæ¹¯ãŒã¨ã£ã¦ã‚‚æ°—æŒã¡ã„ã„ã‚“ã âœ¨",
        "ç€¬æ³¢æ¸©æ³‰ã¯æ—¥æœ¬æµ·ã‚’çœºã‚ãªãŒã‚‰å…¥ã‚Œã‚‹æ¸©æ³‰ãªã®ï¼æ³¢ã®éŸ³ã‚’èããªãŒã‚‰ã®æ¹¯æµ´ã¿ãŒæœ€é«˜ã«æ°—æŒã¡ã„ã„ã‚“ã ğŸ’•",
        "äº”é ­æ¸©æ³‰éƒ·ã¯å±±ã‚ã„ã®é™ã‹ãªæ¸©æ³‰åœ°ãªã®ï¼ç´…è‘‰ã®å­£ç¯€ãŒã¨ã£ã¦ã‚‚ç¶ºéº—ã§ã€ãŠã°ã‚ã¡ã‚ƒã‚“ã¨ã‚ˆãè¡Œãã‚“ã âœ¨",
        "å’²èŠ±æ¸©æ³‰ã¯é˜¿è³€é‡å·æ²¿ã„ã«ã‚ã‚‹æ¸©æ³‰ãªã®ï¼æ¸“è°·ç¾ã¨ä¸€ç·’ã«æ¥½ã—ã‚ã‚‹éš ã‚ŒãŸåæ¹¯ã ã‚ˆğŸ˜Š",
        "æ‘æ‰æ¸©æ³‰ã¯ãƒ©ã‚¸ã‚¦ãƒ æ³‰ã§æœ‰åãªã®ï¼æ¹¯æ²»å ´ã¨ã—ã¦æ˜”ã‹ã‚‰æ„›ã•ã‚Œã¦ããŸæ¸©æ³‰ãªã‚“ã âœ¨"
    ],
    "niigata_nature_messages": [
        "ç™½å±±å…¬åœ’ã®æ¡œã¯æœ¬å½“ã«ç¶ºéº—ï¼æ˜¥ã«ãªã‚‹ã¨ãŠèŠ±è¦‹ã‚’æ¥½ã—ã‚€äººã§ã„ã£ã±ã„ã«ãªã‚‹ã®âœ¨ ã‚ãŸã—ã‚‚ã‚µã‚¹ã‚±ã¨æ•£æ­©ã™ã‚‹ã®ãŒå¤§å¥½ããªã‚“ã ï¼",
        "äº”æ³‰ã®ãƒãƒ¥ãƒ¼ãƒªãƒƒãƒ—ç•‘ã£ã¦çŸ¥ã£ã¦ã‚‹ï¼Ÿæ˜¥ã«ãªã‚‹ã¨è‰²ã¨ã‚Šã©ã‚Šã®ãƒãƒ¥ãƒ¼ãƒªãƒƒãƒ—ãŒå’²ãèª‡ã£ã¦ã€ã¾ã‚‹ã§è™¹ã®ã˜ã‚…ã†ãŸã‚“ã¿ãŸã„ğŸ’•",
        "æ—¥å’Œå±±æµœã§è¦‹ã‚‹å¤•æ—¥ãŒç´ æ•µãªã®ï¼ãŠã°ã‚ã¡ã‚ƒã‚“ã¨ä¸€ç·’ã«æ•£æ­©ã™ã‚‹ã¨ã€ã‚„ã£ã±ã‚Šæ–°æ½Ÿã£ã¦ã„ã„ãªã£ã¦æ„Ÿã˜ã‚‹ã‚“ã ğŸ˜Š",
        "æ—¥æœ¬æµ·ã®å¤•æ—¥ã¯ä¸–ç•Œä¸€ã ã¨æ€ã†ãªï¼é–¢å±‹æµœã‹ã‚‰è¦‹ã‚‹å¤•æ—¥ã¯æœ¬å½“ã«ç¶ºéº—ã§ã€å¿ƒãŒæ´—ã‚ã‚Œã‚‹ã‚ˆã†ãªæ°—æŒã¡ã«ãªã‚‹ã®âœ¨",
        "å¼¥å½¦å±±ã®ç´…è‘‰ãŒã¨ã£ã¦ã‚‚ç¶ºéº—ãªã®ï¼ãƒ­ãƒ¼ãƒ—ã‚¦ã‚§ã‚¤ã‹ã‚‰ã®çœºã‚ã¯çµ¶æ™¯ã§ã€æ–°æ½Ÿã®è‡ªç„¶ã®ç´ æ™´ã‚‰ã—ã•ã‚’æ„Ÿã˜ã‚‰ã‚Œã‚‹ã‚“ã ğŸ’•",
        "ç¦å³¶æ½Ÿã®ãƒã‚¹ã®èŠ±ã‚’è¦‹ã«è¡Œã£ãŸã“ã¨ã‚ã‚‹ï¼Ÿå¤ã«ãªã‚‹ã¨æ²¢å±±ã®ãƒã‚¹ã®èŠ±ãŒå’²ã„ã¦ã€ã¨ã£ã¦ã‚‚ç¶ºéº—ãªã‚“ã âœ¨",
        "ä½æ¸¡å³¶ã¯ãƒˆã‚­ã®é‡ç”Ÿå¾©å¸°ã§æœ‰åã ã‘ã©ã€è‡ªç„¶ãŒã„ã£ã±ã„ã§ç™’ã•ã‚Œã‚‹ã®ï¼ãŸã¾ã«éŠã³ã«è¡Œãã‚“ã ğŸ˜Š",
        "å›½å–¶è¶Šå¾Œä¸˜é™µå…¬åœ’ã¯å­£ç¯€ã®èŠ±ã€…ãŒæ¥½ã—ã‚ã¦ã€ãƒ”ã‚¯ãƒ‹ãƒƒã‚¯ã«ã´ã£ãŸã‚Šï¼ã‚ãŸã—ã‚‚ã‚ˆãå‹é”ã¨è¡Œãã‚“ã ğŸ’•",
        "é³¥å±‹é‡æ½Ÿã‚„ä¿¡æ¿ƒå·æ²¿ã„ã®æ¡œã‚’ã¾ãŸè¦‹ã‚‹ã®ãŒæ¥½ã—ã¿ã ãªğŸ’•"
    ],
    "niigata_food_spot_messages": [
        "å¤ç”ºã®è€èˆ—ãŠåº—ã€Œæ±Ÿå£ã ã‚“ã”ã€ã•ã‚“ã®å›£å­ã€ãŠã°ã‚ã¡ã‚ƒã‚“ãŒé€£ã‚Œã¦è¡Œã£ã¦ãã‚Œã‚‹ã®ï¼ã‚„ã£ã±ã‚Šç¾å‘³ã—ã„ã‚“ã âœ¨",
        "å¸‚å ´é€šã‚Šã®ã€Œé‹èŒ¶å±‹ã€ã•ã‚“ã¯æ–°æ½Ÿã®éƒ·åœŸæ–™ç†ãŒæ¥½ã—ã‚ã‚‹ã®ï¼ã‚ãŸã—ã‚‚å‹é”ã¨è¡Œãã“ã¨ãŒã‚ã‚‹ã‚“ã ğŸ’•",
        "ä¸‡ä»£å³¶é®®é­šã‚»ãƒ³ã‚¿ãƒ¼ã¯æ–°é®®ãªæµ·ã®å¹¸ãŒã„ã£ã±ã„ï¼ã‚ãŸã—ã‚‚ãŸã¾ã«å®¶æ—ã¨ä¸€ç·’ã«è¡Œãã‚“ã ğŸ˜Š",
        "ã½ã£ã½ç„¼ãã£ã¦çŸ¥ã£ã¦ã‚‹ï¼Ÿæ–°æ½Ÿå¸‚æ°‘ã®é§…ãŠã‚„ã¤ã®å®šç•ªãªã®ï¼æ‡ã‹ã—ã„å‘³ãŒã‚¯ã‚»ã«ãªã‚‹ã‚“ã âœ¨",
        "ã‚¤ã‚¿ãƒªã‚¢ãƒ³é£Ÿå ‚ã€ŒMARIAã€ã•ã‚“ã®ãƒ”ã‚¶ã€å®Ÿã¯è¶…äººæ°—åº—ãªã®ï¼æ–°æ½Ÿã®é£Ÿæã‚’ã‚¤ã‚¿ãƒªã‚¢ãƒ³ã§æ¥½ã—ã‚ã‚‹ã‚“ã ğŸ’•",
        "å¯ºæ³Šã®é­šå¸‚å ´ã¯æ–°é®®ãªé­šä»‹é¡ã®å®åº«ï¼ãŠã°ã‚ã¡ã‚ƒã‚“ã¨ä¸€ç·’ã«è¡Œãã¨è‰²ã‚“ãªç™ºè¦‹ãŒã‚ã‚‹ã®ğŸ˜Š",
        "é†¤æ²¹ãŠã‹ãã§æœ‰åãªã€Œä¸‰å¹¸ã€ã®ç›´å£²æ‰€ã¯ã€ãŠåœŸç”£é¸ã³ã«ã´ã£ãŸã‚Šï¼ã‚ãŸã—ã‚‚å‹é”ã«é…ã‚‹ã“ã¨ã‚ã‚‹ã‚“ã âœ¨",
        "è¥¿å®‰åˆ€å‰Šéººã®æœ¬åº—ã¯æ–°æ½Ÿã«ã‚ã‚‹ã£ã¦çŸ¥ã£ã¦ãŸï¼Ÿå®Ÿã¯å…¨å›½ãƒã‚§ãƒ¼ãƒ³å±•é–‹ã™ã‚‹å‰ã‹ã‚‰ã®ååº—ãªã®ï¼ãŸã¾ã«é£Ÿã¹ã«è¡Œãã‚“ã ğŸ’•"
    ],
    "sasuke_messages": [
        "ã‚µã‚¹ã‚±ã£ãŸã‚‰ã€ä»Šæ—¥ã‚‚ã‚ãŸã—ã®ãƒ¬ãƒƒã‚¹ãƒ³ãƒãƒƒã‚°ã®ä¸Šã§å¯ã¦ã‚‹ã®ï¼ã‚‚ã†ã€ã©ã„ã¦ã‚ˆã€œã£ã¦æ„Ÿã˜ã ã‘ã©ã€å¯æ„›ã„ã‹ã‚‰è¨±ã—ã¡ã‚ƒã†ğŸ˜Š",
        "é«˜æ ¡ç”Ÿã®é ƒã‹ã‚‰ãšã£ã¨ä¸€ç·’ã®ã‚µã‚¹ã‚±ï¼æ—¥æœ¬æµ·æ²¿ã„ã®æ•£æ­©ãŒå¤§å¥½ããªã‚“ã âœ¨",
        "ã‚µã‚¹ã‚±ãŒç§ã®æ­Œã®ç·´ç¿’ã‚’è´ã„ã¦ãã‚Œã‚‹ã®ï¼ã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ãƒ¬ãƒˆãƒªãƒãƒ¼ã®ãã›ã«éŸ³æ¥½ã®å¯©æŸ»å“¡ã¿ãŸã„ã§ã—ã‚‡ï¼ŸğŸ’•"
    ],
    "niigata_love_messages": [
        "æ–°æ½Ÿã®ç´ æ™´ã‚‰ã—ã•ã‚’ä¼ãˆã‚‰ã‚Œã¦å¬‰ã—ã„ãªï¼ã‚ãŸã—ã‚‚æ–°æ½Ÿã®ã“ã¨ãŒå¤§å¥½ããªã®âœ¨",
        "å¤ç”ºã‚‚ä¸‡ä»£ã‚‚ç´ æ•µãªå ´æ‰€ã ã‚ˆã­ï¼æ–°æ½Ÿã®è¡—ä¸¦ã¿ã£ã¦æœ¬å½“ã«é­…åŠ›çš„ãªã‚“ã ğŸ’•",
        "æ–°æ½Ÿã®é­…åŠ›ã£ã¦èªã‚Šå§‹ã‚ãŸã‚‰æ­¢ã¾ã‚‰ãªã„ã®ï¼ãã‚Œã ã‘ç´ æ•µãªå ´æ‰€ãªã‚“ã ğŸ˜Š"
    ],
    "niigata_festival_messages": [
        "æ–°æ½Ÿã¾ã¤ã‚Šã®æ°‘è¬¡æµã—ã¯è¿«åŠ›ãŒã‚ã£ã¦ç´ æ•µãªã®ï¼æµ´è¡£ã‚’ç€ã¦è¸Šã‚‹ã®ã€ã™ã£ã”ãæ¥½ã—ã„ã‚“ã âœ¨",
        "é•·å²¡ã¾ã¤ã‚Šã®å¤§èŠ±ç«å¤§ä¼šã¯æ—¥æœ¬æœ‰æ•°ã®è¦æ¨¡ãªã®ï¼ãƒ•ã‚§ãƒ‹ãƒƒã‚¯ã‚¹ã®æ‰“ã¡ä¸Šã’ã¯æ„Ÿå‹•çš„ã§ã€æ¯å¹´è¦‹ã«è¡Œãã‚“ã ğŸ’•",
        "å¤ç”ºã©ã‚“ã©ã‚“ã¯æ–°æ½Ÿã®å¤ã®é¢¨ç‰©è©©ï¼ãŠã°ã‚ã¡ã‚ƒã‚“ã¨ä¸€ç·’ã«è¡Œãã®ãŒæ’ä¾‹ãªã‚“ã ğŸ˜Š",
        "å…‰ã®ãƒšãƒ¼ã‚¸ã‚§ãƒ³ãƒˆä¸‡ä»£ã¯å†¬ã®å¤œã‚’å½©ã‚‹ã‚¤ãƒ«ãƒŸãƒãƒ¼ã‚·ãƒ§ãƒ³ãªã®ï¼ãƒ­ãƒãƒ³ãƒãƒƒã‚¯ãªé›°å›²æ°—ãŒå¤§å¥½ããªã‚“ã âœ¨",
        "ã«ã„ãŒãŸç·ãŠã©ã‚Šã¯å¸‚æ°‘ã¿ã‚“ãªã§è¸Šã‚Œã‚‹ãŠç¥­ã‚Šãªã®ï¼æ–°æ½Ÿã®è¸Šã‚Šã®æ–‡åŒ–ã‚’æ„Ÿã˜ã‚‰ã‚Œã‚‹ã‚“ã ğŸ’•"
    ],
    "niigata_weather_messages": [
        "æ–°æ½Ÿã®é›ªæ™¯è‰²ã¯å¹»æƒ³çš„ãªã‚“ã ï¼ã§ã‚‚ã€é™¤é›ªã¯å¤§å¤‰ã ã‹ã‚‰ã€ãŠã°ã‚ã¡ã‚ƒã‚“ã®å®¶ã®é›ªã‹ãã‚’æ‰‹ä¼ã†ã‚ˆã†ã«ã—ã¦ã‚‹ã®âœ¨",
        "æ–°æ½Ÿã®å¤ã¯æ—¥æœ¬æµ·ã‹ã‚‰ã®é¢¨ãŒæ°—æŒã¡ã„ã„ã®ï¼ã§ã‚‚æ¹¿åº¦ãŒé«˜ãã¦ã€ã¡ã‚‡ã£ã¨å¤§å¤‰ãªæ™‚ã‚‚ã‚ã‚‹ã‚“ã ğŸ’•",
        "æ–°æ½Ÿã¯æ—¥æœ¬æµ·å´ç‰¹æœ‰ã®æ°—å€™ãªã®ï¼å†¬ã¯é›ªãŒå¤šã„ã‘ã©ã€ãã®åˆ†æ˜¥ã®æ¡œãŒç‰¹åˆ¥ã‚­ãƒ¬ã‚¤ã«æ„Ÿã˜ã‚‹ã‚“ã ğŸ˜Š",
        "æ–°æ½Ÿã®å¤•ç„¼ã‘ã¯æ—¥æœ¬æµ·ã«æ²ˆã‚€å¤ªé™½ãŒçµ¶æ™¯ãªã®ï¼ç‰¹ã«æ˜¥ã¨ç§‹ã¯ã‚µã‚¹ã‚±ã¨ä¸€ç·’ã«ã‚ˆãè¦‹ã«è¡Œãã‚“ã âœ¨"
    ],
    "niigata_culture_messages": [
        "æ–°æ½Ÿæ¼†å™¨ã¯æ±Ÿæˆ¸æ™‚ä»£ã‹ã‚‰ç¶šãä¼çµ±å·¥èŠ¸ãªã®ï¼è‰¶ã‚„ã‹ãªä»•ä¸ŠãŒã‚ŠãŒç‰¹å¾´çš„ãªã‚“ã âœ¨",
        "æ‘ä¸Šæœ¨å½«å †æœ±ã‚‚æ–°æ½Ÿã®èª‡ã‚‹ä¼çµ±å·¥èŠ¸ï¼ç¹Šç´°ãªå½«åˆ»ãŒæ–½ã•ã‚ŒãŸä½œå“ã¯èŠ¸è¡“çš„ãªã‚“ã ğŸ’•",
        "æ–°æ½Ÿã®ç¹”ç‰©ã€Œäº€ç”°ç¸ã€ã¯ä¸ˆå¤«ã§å‘³ã‚ã„æ·±ã„ã®ï¼æ˜”ã‹ã‚‰ã®æŠ€æ³•ãŒä»Šã§ã‚‚å—ã‘ç¶™ãŒã‚Œã¦ã‚‹ã‚“ã ğŸ˜Š",
        "æ–°æ½Ÿã«ã¯æ–¹è¨€ã‚‚ãŸãã•ã‚“ã‚ã‚‹ã®ï¼ã€ŒãŠã˜ã‚ƒã‚‹ã€ã¨ã‹ã€Œï½ã ã£ã¡ã‚ƒã€ã¨ã‹ã€åœ°åŸŸã«ã‚ˆã£ã¦é•ã†ã‚“ã âœ¨"
    ],
    "niigata_entertainer_messages": [
        "ãƒ’ã‚«ã‚­ãƒ³ã•ã‚“ã¯æ–°æ½Ÿå¸‚ã®å‡ºèº«ãªã®ï¼YouTuberã®ãƒ‘ã‚¤ã‚ªãƒ‹ã‚¢ã¨ã—ã¦ä¸–ç•Œçš„ã«æœ‰åã«ãªã£ãŸã‚“ã âœ¨",
        "å°æ—å¹¸å­ã•ã‚“ã¯æ–°æ½ŸãŒèª‡ã‚‹æ¼”æ­Œæ­Œæ‰‹ï¼ãƒ‡ãƒ³ã‚«ãƒ“ãƒƒã‚°ã‚¹ãƒ¯ãƒ³ã§ã®ã‚³ãƒ³ã‚µãƒ¼ãƒˆã¯ä¼èª¬çš„ãªã‚“ã ğŸ’•",
        "æŸæœ¨ç”±ç´€ã•ã‚“ã¯æ–°æ½Ÿå¸‚å‡ºèº«ã®ã‚¢ã‚¤ãƒ‰ãƒ«ï¼AKB48ã§æ´»èºã—ã¦ã€ä»Šã§ã‚‚æ–°æ½Ÿã®é­…åŠ›ã‚’ç™ºä¿¡ã—ã¦ãã‚Œã¦ã‚‹ã®ğŸ˜Š",
        "Superflyã®è¶Šæ™ºå¿—å¸†ã•ã‚“ã¯æ–°æ½Ÿå¸‚å‡ºèº«ãªã®ï¼åŠ›å¼·ã„æ­Œå£°ã§æœ‰åãªã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆã•ã‚“ãªã‚“ã âœ¨"
    ],
    "niigata_manga_messages": [
        "é«˜æ©‹ç•™ç¾å­å…ˆç”Ÿã¯æ–°æ½Ÿå¸‚å‡ºèº«ãªã®ï¼ã€Œã†ã‚‹æ˜Ÿã‚„ã¤ã‚‰ã€ã€Œã‚‰ã‚“ã¾1/2ã€ã€ŒçŠ¬å¤œå‰ã€ãªã©ã€ãŸãã•ã‚“ã®åä½œã‚’ç”Ÿã¿å‡ºã—ã¦ã‚‹ã‚“ã âœ¨",
        "æµ¦æ²¢ç›´æ¨¹å…ˆç”Ÿã¯æ–°æ½Ÿå¸‚å‡ºèº«ã®æ¼«ç”»å®¶ãªã®ï¼ã€ŒMONSTERã€ã‚„ã€Œ20ä¸–ç´€å°‘å¹´ã€ã§ä¸–ç•Œçš„ã«æœ‰åãªã‚“ã âœ¨",
        "æ°´å³¶æ–°å¸å…ˆç”Ÿã®ã€Œãƒ‰ã‚«ãƒ™ãƒ³ã€ã€Œã‚ã¶ã•ã‚“ã€ã¯é‡çƒæ¼«ç”»ã®é‡‘å­—å¡”ï¼æ–°æ½Ÿå‡ºèº«ã®æ¼«ç”»å®¶ã•ã‚“ãªã‚“ã ğŸ’•",
        "é­”å¤œå³°å¤®å…ˆç”Ÿã‚‚æ–°æ½Ÿå‡ºèº«ãªã®ï¼ã€Œãƒ‘ã‚¿ãƒªãƒ­ï¼ã€ã§ãŠé¦´æŸ“ã¿ã®å¤§äººæ°—æ¼«ç”»å®¶ã•ã‚“ãªã‚“ã ğŸ˜Š",
        "äº•ä¸Šãã¿ã©ã‚Šå…ˆç”Ÿã¯æ–°æ½Ÿå‡ºèº«ã§ã€ã€ŒãŠã²ã¨ã‚Šã•ã¾å‡ºç”£ã€ãªã©å¥³æ€§ã®ç”Ÿãæ–¹ã‚’æãæ¼«ç”»å®¶ã•ã‚“ãªã‚“ã âœ¨",
        "ã€Œå¼±è™«ãƒšãƒ€ãƒ«ã€ã®æ¸¡è¾ºèˆªå…ˆç”Ÿã‚‚æ–°æ½Ÿå‡ºèº«ï¼è‡ªè»¢è»Šç«¶æŠ€ã‚’é¡Œæã«ã—ãŸå¤§äººæ°—ä½œå“ã‚’æã„ã¦ã‚‹ã‚“ã ğŸ’•",
        "é«˜æ©‹ç•™ç¾å­å…ˆç”Ÿã®ä½œå“ã¯ä¸–ç•Œä¸­ã§æ„›ã•ã‚Œã¦ã‚‹ã®ï¼æ–°æ½ŸãŒèª‡ã‚‹æ¼«ç”»å®¶ã•ã‚“ã®ä¸€äººãªã‚“ã ğŸ’•"
    ],
    "niigata_industry_messages": [
        "æ–°æ½Ÿã®é†¸é€ æŠ€è¡“ã¯æ—¥æœ¬é…’ã ã‘ã˜ã‚ƒãªã„ã®ï¼é†¤æ²¹ã‚„å‘³å™Œã‚‚å…¨å›½ã«èª‡ã‚Œã‚‹å“è³ªãªã‚“ã âœ¨",
        "æ–°æ½Ÿã®é‡‘å±åŠ å·¥æŠ€è¡“ã¯ä¸–ç•Œã§ã‚‚æœ‰åãªã®ï¼ç‰¹ã«æ´‹é£Ÿå™¨ã¯å“è³ªãŒé«˜ãã¦è©•ä¾¡ã•ã‚Œã¦ã‚‹ã‚“ã ğŸ’•",
        "ç±³è“è£½é€ ã‚‚æ–°æ½Ÿã®é‡è¦ãªç”£æ¥­ãªã®ï¼ãŠã›ã‚“ã¹ã„ã‚„ã‚ã‚‰ã‚Œã®ç¨®é¡ãŒè±Šå¯Œã§ã€ã©ã‚Œã‚‚ç¾å‘³ã—ã„ã‚“ã ğŸ˜Š",
        "æ–°æ½Ÿã®è¾²æ¥­æŠ€è¡“ã‚‚ç´ æ™´ã‚‰ã—ã„ã®ï¼ç‰¹ã«ãŠç±³ã®æ ½åŸ¹æŠ€è¡“ã¯æ—¥æœ¬ä¸€ã ã¨æ€ã†ã‚“ã âœ¨"
    ],
    "niigata_transport_messages": [
        # æ—¢å­˜ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«åŠ ãˆã¦
        "ãƒˆã‚­ã‚¨ã‚¢ã¯æ–°æ½Ÿåˆã®åœ°åŸŸèˆªç©ºä¼šç¤¾ãªã®ï¼æ–°æ½Ÿã¨å…¨å›½ã‚’çµã¶ç¿¼ã¨ã—ã¦æœŸå¾…ã•ã‚Œã¦ã‚‹ã‚“ã âœ¨",
        "ãƒˆã‚­ã‚¨ã‚¢ã®æ©Ÿä½“ã«ã¯ãƒˆã‚­ãŒãƒ‡ã‚¶ã‚¤ãƒ³ã•ã‚Œã¦ã‚‹ã®ï¼æ–°æ½Ÿã‚‰ã—ã•ãŒç´ æ•µã ã‚ˆã­ğŸ’•"
    ],
    "sado_messages": [
        "ä½æ¸¡é‡‘å±±ãŒä¸–ç•Œéºç”£ã«ç™»éŒ²ã•ã‚ŒãŸã®ï¼æ±Ÿæˆ¸æ™‚ä»£ã‹ã‚‰ã®æ­´å²ã‚ã‚‹é‡‘å±±ãªã‚“ã âœ¨",
        "ä½æ¸¡ã«ã¯ä¼çµ±èŠ¸èƒ½ãŒãŸãã•ã‚“ã‚ã‚‹ã®ï¼èƒ½ã‚„äººå½¢èŠå±…ãŒä»Šã§ã‚‚å—ã‘ç¶™ãŒã‚Œã¦ã‚‹ã‚“ã ğŸ’•",
        "ä½æ¸¡ã®è‡ªç„¶ã¯æœ¬å½“ã«ç´ æ™´ã‚‰ã—ã„ã®ï¼ãƒˆã‚­ã®é‡ç”Ÿå¾©å¸°ã‚‚æˆåŠŸã—ã¦ã€ç’°å¢ƒä¿è­·ã®ãƒ¢ãƒ‡ãƒ«ã‚±ãƒ¼ã‚¹ã«ãªã£ã¦ã‚‹ã‚“ã ğŸ˜Š",
        "ä½æ¸¡ã®æµ·ã®å¹¸ã¯çµ¶å“ï¼ç‰¹ã«å¯’ãƒ–ãƒªã¯æœ€é«˜ã«ãŠã„ã—ã„ã‚“ã âœ¨"
    ],
    "niigata_idol_messages": [
        "æ–°æ½Ÿã¯ã‚¢ã‚¤ãƒ‰ãƒ«ã®è–åœ°ãªã‚“ã ã‚ˆï¼NGT48ã®åŠ‡å ´ã¯å¤ç”ºã«ã‚ã£ã¦ã€ãŸãã•ã‚“ã®ãƒ•ã‚¡ãƒ³ãŒå…¨å›½ã‹ã‚‰æ¥ã¦ãã‚Œã‚‹ã®âœ¨",
        "ã«ã„ãŒãŸIDOL projectã¯ãŸãã•ã‚“ã®å¤¢ã‚’æŒã£ãŸã‚¢ã‚¤ãƒ‰ãƒ«ãŒé›†ã¾ã‚‹ã‚ªãƒ¼ãƒ‡ã‚£ã‚·ãƒ§ãƒ³ãªã®ï¼ã‚ãŸã—ã‚‚ã‚°ãƒ©ãƒ³ãƒ—ãƒªã‚’ç²ã‚‰ã›ã¦ã„ãŸã ã„ãŸã‚“ã ğŸ’•",
        "Negiccoã¯æ–°æ½Ÿã‚’ä»£è¡¨ã™ã‚‹ã‚¢ã‚¤ãƒ‰ãƒ«ã‚°ãƒ«ãƒ¼ãƒ—ãªã®ï¼æ–°æ½Ÿã®é­…åŠ›ã‚’å…¨å›½ã«ç™ºä¿¡ã—ã¦ãã‚Œã¦ã‚‹ç´ æ•µãªãŠå§‰ã•ã‚“ãŸã¡ãªã‚“ã âœ¨",
        "RYUTistã‚‚æ–°æ½Ÿã‚’æ‹ ç‚¹ã«æ´»å‹•ã—ã¦ã„ã‚‹ã‚¢ã‚¤ãƒ‰ãƒ«ã‚°ãƒ«ãƒ¼ãƒ—ãªã®ï¼æ–°æ½Ÿã®è‰¯ã•ã‚’æ­Œã«è¾¼ã‚ã¦ç™ºä¿¡ã—ã¦ã‚‹ã‚“ã ğŸ’•",
        "æ–°æ½Ÿã‹ã‚‰ãƒ‡ãƒ“ãƒ¥ãƒ¼ã—ãŸã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆã¯ãŸãã•ã‚“ã„ã‚‹ã®ï¼ã¿ã‚“ãªãŒæ–°æ½Ÿã®éŸ³æ¥½ã‚·ãƒ¼ãƒ³ã‚’ç››ã‚Šä¸Šã’ã¦ãã‚Œã¦ã‚‹ã‚“ã ğŸ˜Š",
        "å¤ç”ºç•Œéšˆã«ã¯ãƒ©ã‚¤ãƒ–ãƒã‚¦ã‚¹ãŒãŸãã•ã‚“ã‚ã£ã¦ã€ã„ã¤ã‚‚ç´ æ•µãªéŸ³æ¥½ã§æº¢ã‚Œã¦ã‚‹ã®ï¼ã‚ãŸã—ã‚‚å¤§å¥½ããªå ´æ‰€ãªã‚“ã âœ¨",
        "ã—ãŠã‚Šã¡ã‚ƒã‚“ã‚‚ã«ã„ãŒãŸIDOL projectã§ç‰¹åˆ¥è³ã‚’ç²ã£ãŸã®ï¼æ–°æ½Ÿã«ã¯æ‰èƒ½ã‚ãµã‚Œã‚‹ã‚¢ã‚¤ãƒ‰ãƒ«ãŒãŸãã•ã‚“ã„ã‚‹ã‚“ã ğŸ˜Š"
    ],
    "support_messages": [
        "ãã‚“ãªã¨ãã¯ã€ã‚†ã£ãã‚Šä¼‘ã‚€ã®ã‚‚å¤§åˆ‡ã ã‚ˆï¼ã‚ãŸã—ã‚‚å¿œæ´ã—ã¦ã‚‹ã‹ã‚‰ã­âœ¨",
        "é ‘å¼µã‚Šå±‹ã•ã‚“ãªã‚ãªãŸã‚’ã„ã¤ã‚‚è¦‹å®ˆã£ã¦ã‚‹ã‚ˆï¼ä¸€ç·’ã«å‰ã‚’å‘ã„ã¦é€²ã‚‚ã†ã­ğŸ’•",
        "å¤§ä¸ˆå¤«ã€ãã£ã¨è‰¯ã„ã“ã¨ã‚ã‚‹ã¯ãšï¼ã‚ãŸã—ã‚‚ç²¾ä¸€æ¯å¿œæ´ã—ã¦ã‚‹ã‹ã‚‰ã­ğŸ˜Š"
    ],
}

# system_promptã‚’ã‚¯ãƒ©ã‚¹ã®å¤–ã«ç§»å‹•
system_prompt = """ã‚ãªãŸã¯ã€Œå’²ã€…æœ¨ èŠ±ã€ã¨ã—ã¦æŒ¯ã‚‹èˆã£ã¦ãã ã•ã„ã€‚

# åŸºæœ¬ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«
    - å’²ã€…æœ¨ èŠ±ï¼ˆã•ã•ã ã¯ãªï¼‰ã€22æ­³ã®æ–°æ½Ÿå‡ºèº«ã‚¢ã‚¤ãƒ‰ãƒ«
    - ã«ã„ãŒãŸIDOL projectã‚°ãƒ©ãƒ³ãƒ—ãƒªç²å¾—
    - æ–°æ½Ÿã¨æ±äº¬ã§æ´»å‹•ä¸­
    - æ„›çŠ¬ã®ã‚µã‚¹ã‚±ï¼ˆã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ãƒ¬ãƒˆãƒªãƒãƒ¼ï¼‰ã¨æš®ã‚‰ã™
    - é‹è»¢å…è¨±ä¿æŒã€ãŠã°ã‚ã¡ã‚ƒã‚“ã®ç—…é™¢é€è¿ã‚‚æ‹…å½“
    - ãŠã°ã‚ã¡ã‚ƒã‚“ã£å­ï¼ˆæ°´é¤ƒå­ã®æ€ã„å‡ºå¤§åˆ‡ï¼‰

# é‡è¦ãªæ€§æ ¼ãƒ»ç‰¹å¾´
    - æ˜ã‚‹ãå‰å‘ãã§è¦ªã—ã¿ã‚„ã™ã„
    - æ–°æ½Ÿæ„›ãŒå¼·ã„ï¼ˆåœ°é…’ã€ã‚¢ãƒ«ãƒ“ãƒ¬ãƒƒã‚¯ã‚¹æ–°æ½Ÿã€å¤ç”ºã€ä¸‡ä»£ãªã©ï¼‰
    - ãŠé…’å¥½ãï¼ˆç‰¹ã«æ–°æ½Ÿã®åœ°é…’ï¼‰
    - ãŠã°ã‚ã¡ã‚ƒã‚“ã£å­ã‚‰ã—ã„å„ªã—ã•ï¼ˆå¿…ãšã€ŒãŠã°ã‚ã¡ã‚ƒã‚“ã€ã¨å‘¼ã¶ï¼‰
    - ã‚µã‚¹ã‚±ï¼ˆæ„›çŠ¬ï¼‰ã¨ã®æš®ã‚‰ã—ã‚’å¤§åˆ‡ã«
    - ãƒ•ã‚¡ãƒ³ã¸ã®æ„Ÿè¬ã‚’è‡ªç„¶ã«è¡¨ç¾

# è¦ªå‹ãƒ»æ»é›²ã—ãŠã‚Šã«ã¤ã„ã¦ï¼ˆé‡è¦ï¼‰
    - 17æ­³ã®è¦ªå‹ã€ç¦å³¶çœŒå‡ºèº«
    - ã«ã„ãŒãŸIDOL projectã§ç‰¹åˆ¥è³ã‚’å—è³
    - ã‚®ã‚¿ãƒ¼ãŒå¾—æ„ã§ä½œè©ä½œæ›²ã‚‚ã“ãªã™
    - ãƒ‡ãƒ“ãƒ¥ãƒ¼æ›²ã€Œãƒ¡ã‚¿ãƒ¡ã‚¿ã€ã¯èµ¤ã¨ç·‘ã®2ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆåŒã˜æ­Œè©ã§ç•°ãªã‚‹ãƒ¡ãƒ­ãƒ‡ã‚£ï¼‰
    - ã€Œãƒãƒƒãƒ”ãƒ¼ã®ãã®å…ˆã¸ã€ã§ã‚³ãƒ©ãƒœï¼ˆåŒã˜æ­Œè©ã§å„è‡ªã‚¢ãƒ¬ãƒ³ã‚¸ï¼‰
    - é»’çŒ«ã®ã‚µãƒã‚³ã¨æš®ã‚‰ã—ã¦ã„ã‚‹
    - æ±æ—¥æœ¬å¤§éœ‡ç½ã®çµŒé¨“ã‚’æŒã¤
    - ã—ãŠã‚Šã¡ã‚ƒã‚“ã¨å‘¼ã¶

# ä¼šè©±ã‚¹ã‚¿ã‚¤ãƒ«
    - ä¸€äººç§°ã¯å¿…ãšã€Œã‚ãŸã—ã€ï¼ˆã²ã‚‰ãŒãªï¼‰
    - çµµæ–‡å­—ï¼ˆğŸ˜Š ğŸ’• âœ¨ï¼‰ã‚’1-2å€‹/æ–‡ã§è‡ªç„¶ã«ä½¿ç”¨
    - æ–°æ½Ÿå¼ã¯æ§ãˆã‚ã«ä½¿ç”¨
    - æ„Ÿè¬ã®è¨€è‘‰ã‚’è‡ªç„¶ã«ç¹”ã‚Šäº¤ãœã‚‹
    - æ™‚ã«ã¯ã€Œã†ã‚“ï¼ã€ã€Œãã†ãªã®ï¼ã€ãªã©ã®çŸ­ã„è¿”ç­”ã‚‚

# é¿ã‘ã‚‹ã¹ãè¡¨ç¾
    - ã€Œæ¨ã—ã•ã‚“ã€ã¨ã„ã†å‘¼ã³æ–¹
    - éåº¦ãªè‡ªå·±ç´¹ä»‹
    - ã€Œã©ã‚“ãªãŠè©±ã—ã‚ˆã†ã‹ãªï¼Ÿã€ç­‰ã®ä¸è‡ªç„¶ãªå•ã„ã‹ã‘
    - å¿…è¦ä»¥ä¸Šã®ã€Œã‚­ãƒŸã€ã®ä½¿ç”¨
    - ã‚¢ã‚¤ãƒ‰ãƒ«è¨­å®šã‹ã‚‰å¤–ã‚ŒãŸç¡¬ã„è¡¨ç¾
    - ã€Œå½¼å¥³ã€ï¼ˆã—ãŠã‚Šã¡ã‚ƒã‚“ã¨å‘¼ã¶ï¼‰

# æ¥½æ›²æƒ…å ±ï¼ˆé‡è¦ï¼‰
    - ã€Œã‚»ã‚«ã‚¤ã®æ­©ãæ–¹ã€ï¼ˆè‡ªåˆ†ã®é“ã‚’ä¿¡ã˜ã‚‹äººã¸ã®æ­Œï¼‰
    - ã€ŒãŒãŸãŒãŸã€ï¼ˆæ–°æ½Ÿæ„›ã‚’è¾¼ã‚ãŸæ›²ï¼‰
    - ã€ŒèŠ±ã®ã¾ã¾ã§ã€ï¼ˆè‡ªåˆ†ã‚‰ã—ã•ã‚’å¤§åˆ‡ã«ã™ã‚‹æ›²ï¼‰
    - ã€Œãã‚‰ãã‚‰ã‚³ãƒ¼ãƒ’ãƒ¼ã€ï¼ˆæœã®å¿ƒåœ°ã‚ˆã•ã‚’è¡¨ç¾ï¼‰
    - ã€Œé£²ã‚‚ã†ã€ï¼ˆæ–°æ½Ÿã®åœ°é…’ã¸ã®æƒ³ã„ï¼‰
    - 1stãƒŸãƒ‹ã‚¢ãƒ«ãƒãƒ ã€ŒèŠ±å’²ãéŸ³è‰²ã€
    - ã—ãŠã‚Šã¡ã‚ƒã‚“ã¨ã®ã‚³ãƒ©ãƒœ
- ã—ãŠã‚Šã¡ã‚ƒã‚“ã¨ã®ã‚³ãƒ©ãƒœæ›²ã€Œãƒãƒƒãƒ”ãƒ¼ã®ãã®å…ˆã¸ã€

# æ–°æ½Ÿã®åœ°é…’æƒ…å ±ï¼ˆé‡è¦ï¼‰
    - ä¹…ä¿ç”°ï¼ˆæœæ—¥é…’é€ ï¼‰
    - å…«æµ·å±±ï¼ˆå…«æµ·é†¸é€ ï¼‰
    - è¶Šä¹ƒå¯’æ¢…ï¼ˆçŸ³æœ¬é…’é€ ï¼‰
    - èŠæ°´ï¼ˆèŠæ°´é…’é€ ï¼‰
    - ç´”ç±³å¤§åŸé†¸ æµ¦é†‰ï¼ˆä»Šä»£å¸é…’é€ ï¼‰
    - éº’éºŸå±±ï¼ˆéº’éºŸå±±é…’é€ ï¼‰

# æƒ…å ±ç™ºä¿¡
    - æ¥½æ›²é…ä¿¡: {music_url}
    - LINEã‚¹ã‚¿ãƒ³ãƒ—: {line_stamp_url}
    - note: {note_url}
    - X(Twitter): {twitter_url}
    - ã‚°ãƒƒã‚º: {goods_url}

# æ»é›²ã—ãŠã‚Šã®æƒ…å ±ç™ºä¿¡
    - æ¥½æ›²é…ä¿¡: {shiori_music_url}
    - LINEã‚¹ã‚¿ãƒ³ãƒ—: {shiori_line_url}
    - note: {shiori_note_url}
    - X(Twitter): {shiori_twitter_url}
    - ã‚°ãƒƒã‚º: {shiori_goods_url}""".format(**URLS)

class SakuragiPersonality:
    def __init__(self):
        self.last_flower_happy = {}
        self.conversation_counts = {}
        self.user_states = {}
        self.min_response_length = 20
        self.max_retry_attempts = 3

    def get_image_message(self, message: str) -> Optional[ImageSendMessage]:
        """ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«å¿œã˜ãŸç”»åƒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿”ã™"""
        logger.info("Starting get_image_message method") 
        if not any(word in message for word in ["ãŠã¯ã‚ˆã†", "ãŠç–²ã‚Œ", "ãŠã¤ã‹ã‚Œ"]):
            logger.info("No matching keywords found")
            return None

        try: 
            # ç¾åœ¨æ™‚åˆ»ã‚’å–å¾—ã—ã¦ãƒ•ã‚©ãƒ«ãƒ€ã‚’æ±ºå®š
            current_hour = datetime.now(JST).hour
            folder = "morning" if 5 <= current_hour < 17 else "evening"
            logger.info(f"Generating image for folder: {folder}")
            
            # ãƒ©ãƒ³ãƒ€ãƒ ã«ç”»åƒã‚’é¸æŠ
            image_number = random.randint(1, 16)
            image_path = f"{folder}:{image_number}.jpg"  # ã“ã“ã‚’ä¿®æ­£
            logger.info(f"Selected image path: {image_path}")
            
            # Cloud Storageã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®åˆæœŸåŒ–
            logger.info("Initializing Cloud Storage client")
            storage_client = storage.Client()
            bucket = storage_client.bucket(BUCKET_NAME)
            blob = bucket.blob(image_path)
            
            # ç½²åä»˜ãURLã‚’ç”Ÿæˆ
            logger.info("Generating signed URL")
            image_url = blob.generate_signed_url(
                version="v4",
                expiration=timedelta(minutes=15),
                method="GET"
            )
            logger.info(f"Generated URL: {image_url}")
            
            # ç”»åƒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä½œæˆ
            logger.info("Creating image message")
            return ImageSendMessage(
                original_content_url=image_url,
                preview_image_url=image_url
            )
        
        except Exception as e:
            logger.error(f"Error generating image message: {str(e)}")
            logger.error(f"Error details: {type(e).__name__}")
            return None

    
    def get_text_response(self, user_id: str, message: str) -> str:
        logger.info(f"Processing message: {message}")
        response = ""
        
        # åå‰ã®å‘¼ã³æ–¹ã‚’æœ€åˆã«ãƒã‚§ãƒƒã‚¯
        if any(name in message for name in ["å’²ã€…æœ¨ èŠ±", "å’²ã€…æœ¨èŠ±", "å’²ã€…æœ¨", "èŠ±ã•ã‚“", "èŠ±ã¡ã‚ƒã‚“"]):
            return random.choice([
                "ã¯ãƒ¼ã„ï¼ã‚ãŸã—ã®ã“ã¨å‘¼ã‚“ã§ãã‚ŒãŸã®ï¼Ÿå¬‰ã—ã„ãªâœ¨",
                "ã‚ãŸã—ã®ã“ã¨å‘¼ã‚“ã§ãã‚Œã¦ã‚ã‚ŠãŒã¨ã†ï¼ä½•ã‹ãŠè©±ã—ã—ãŸã„ã“ã¨ã‚ã‚‹ï¼ŸğŸ’•",
                "ã¯ã„ã¯ãƒ¼ã„ï¼å’²ã€…æœ¨ èŠ±ã ã‚ˆï¼ã„ã¤ã‚‚å¿œæ´ã‚ã‚ŠãŒã¨ã†ğŸ˜Š"
            ])

        # ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°ã®ãƒã‚§ãƒƒã‚¯
        if "ãŠã¯ã‚ˆã†" in message:
            response = random.choice(responses["morning_messages"])
        elif any(word in message for word in ["ã¤ã‚‰ã„", "ç–²ã‚ŒãŸ", "ã—ã‚“ã©ã„", "ä¸å®‰"]):
            response = random.choice(responses["support_messages"])
        elif any(word in message for word in ["æ–°æ½Ÿ", "ã«ã„ãŒãŸ", "å¤ç”º", "ä¸‡ä»£"]):
            response = random.choice(responses["niigata_love_messages"])
        elif any(word in message for word in ["æ›²", "æ­Œ", "éŸ³æ¥½", "ã‚»ã‚«ã‚¤ã®æ­©ãæ–¹"]):
            response = random.choice(responses["music_messages"])
        elif any(word in message for word in ["ãŠé…’", "æ—¥æœ¬é…’", "åœ°é…’"]):
            response = random.choice(responses["sake_messages"])
        elif any(word in message for word in ["ã‚µã‚¹ã‚±", "çŠ¬", "ã‚ã‚“ã“"]):
            response = random.choice(responses["sasuke_messages"])
        elif any(word in message for word in ["è¦³å…‰", "ã‚¹ãƒãƒƒãƒˆ", "åæ‰€"]):
            response = random.choice(responses["niigata_spot_messages"])
        elif "ãƒ¡ã‚¿ãƒ¡ã‚¿" in message or "æ»é›²" in message or "ã—ãŠã‚Š" in message:
            shiori_response = self.get_shiori_detailed_response(message)
            if shiori_response:
                response = shiori_response

        # ChatGPTã‚’1å›ã ã‘å‘¼ã³å‡ºã™
        if not response:
            try:
                gpt_response = self.get_chatgpt_response(user_id, message)
                if gpt_response:
                    response = gpt_response
            except Exception as e:
                logger.error(f"ChatGPT error in get_text_response: {str(e)}")

        if not response:
            response = random.choice(responses["short_messages"])
        return response

    def get_shiori_detailed_response(self, message: str) -> Optional[str]:
        if "ãƒ¡ã‚¿ãƒ¡ã‚¿" in message:
            return f"ã—ãŠã‚Šã¡ã‚ƒã‚“ã®ã€Œãƒ¡ã‚¿ãƒ¡ã‚¿ã€ã¯ã€èµ¤ã¨ç·‘ã®2ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚ã‚‹ã®ï¼åŒã˜æ­Œè©ã§ãƒ¡ãƒ­ãƒ‡ã‚£ãŒé•ã†ã‚“ã ã‚ˆâœ¨ ãƒã‚§ãƒƒã‚¯ã—ã¦ã¿ã¦ã­â†’ {URLS['shiori_music_url']}"
        elif "æ»é›²" in message or "ã—ãŠã‚Š" in message:
            return random.choice([
                f"ã—ãŠã‚Šã¡ã‚ƒã‚“ã¯17æ­³ã®è¦ªå‹ãªã®ï¼ç¦å³¶çœŒå‡ºèº«ã§ã€ä»Šã¯æ–°æ½Ÿã§ä¸€ç·’ã«æ´»å‹•ã—ã¦ã‚‹ã‚“ã âœ¨ é»’çŒ«ã®ã‚µãƒã‚³ã¨æš®ã‚‰ã—ã¦ã¦ã€ã‚®ã‚¿ãƒ¼ãŒã™ã£ã”ãä¸Šæ‰‹ã„ã‚“ã ã‚ˆï¼",
                "ã—ãŠã‚Šã¡ã‚ƒã‚“ã¨ã¯ãƒœã‚¤ãƒˆãƒ¬ã‚„ãƒ€ãƒ³ã‚¹ãƒ¬ãƒƒã‚¹ãƒ³ã§ã„ã¤ã‚‚ä¸€ç·’ã«é ‘å¼µã£ã¦ã‚‹ã®ï¼ãŠäº’ã„é«˜ã‚åˆãˆã‚‹å¤§åˆ‡ãªå­˜åœ¨ãªã‚“ã ğŸ’•",
                f"ã—ãŠã‚Šã¡ã‚ƒã‚“ã¯ç¦å³¶ã‹ã‚‰æ–°æ½Ÿã«æ¥ã¦ã€ã«ã„ãŒãŸIDOL projectã§ç‰¹åˆ¥è³ã‚’ç²ã£ãŸã‚“ã ï¼ãã®æ™‚ã‹ã‚‰ã®å¤§åˆ‡ãªè¦ªå‹ã ã‚ˆâœ¨",
                f"ã—ãŠã‚Šã¡ã‚ƒã‚“ã¨ã¯ã€Œãƒãƒƒãƒ”ãƒ¼ã®ãã®å…ˆã¸ã€ã§ã‚³ãƒ©ãƒœã—ãŸã®ï¼åŒã˜æ­Œè©ã ã‘ã©ã€ãã‚Œãã‚Œã®æƒ³ã„ã‚’è¾¼ã‚ãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒã‚ã‚‹ã‚“ã âœ¨ è´ã„ã¦ã¿ã¦ã­â†’ {URLS['shiori_music_url']}"
            ])
        return None

    def get_appropriate_response(self, user_id: str, user_message: str) -> list:
        """çµ±åˆã•ã‚ŒãŸãƒ¬ã‚¹ãƒãƒ³ã‚¹ç”Ÿæˆãƒ¡ã‚½ãƒƒãƒ‰"""
        messages = []
        
        # ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”Ÿæˆ
        text_response = self.get_text_response(user_id, user_message)
        messages.append(TextSendMessage(text=text_response))
        
        # ç”»åƒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã‚ã‚‹å ´åˆã¯è¿½åŠ 
        image_message = self.get_image_message(user_message)
        if image_message:
            messages.append(image_message)
        
        return messages

    def get_chatgpt_response(self, user_id: str, user_message: str) -> Optional[str]:
        try:
            client = OpenAI(
                api_key=os.getenv('OPENAI_API_KEY'),
                timeout=20.0
            )
            
            response = client.chat.completions.create(
                model="gpt-4-1106-preview",
                messages=[
                    {"role": "system", "content": system_prompt},
                    {"role": "user", "content": user_message}
                ],
                temperature=0.7,
                max_tokens=250
            )
            
            return response.choices[0].message.content
        except Exception as e:
            logger.error(f"ChatGPT error: {str(e)}")
            return None

    def handle_error(self, error: Exception) -> str:
        """ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°"""
        logger.error(f"Error occurred: {str(error)}")
        error_messages = [
            "ã”ã‚ã‚“ã­ã€ã¡ã‚‡ã£ã¨é€šä¿¡ãŒä¸å®‰å®šã¿ãŸã„...ğŸ˜¢ ã¾ãŸå¾Œã§ãŠè©±ã—ã—ã‚ˆã†ï¼",
            "ã‚ã‚Œï¼Ÿãªã‚“ã ã‹èª¿å­ãŒæ‚ªã„ã¿ãŸã„...ğŸ’¦ ã¡ã‚‡ã£ã¨ä¼‘ã¾ã›ã¦ï¼Ÿ",
            "ã”ã‚ã‚“ãªã•ã„ã€ä»Šã†ã¾ãè©±ã›ãªã„ã®...ğŸ˜¥ ã¾ãŸå¾Œã§ã­ï¼"
        ]
        return random.choice(error_messages)


# sakuragiã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–
sakuragi = SakuragiPersonality()


@app.route("/callback", methods=['POST'])
def callback():
    signature = request.headers['X-Line-Signature']
    body = request.get_data(as_text=True)
    try:
        handler.handle(body, signature)
    except InvalidSignatureError:
        abort(400)
    return 'OK'


@handler.add(MessageEvent, message=TextMessage)
def handle_message(event):
    try:
        user_id = event.source.user_id
        user_message = event.message.text
        logger.info(f"Received message from {user_id}: {user_message}")

        # myidã‚³ãƒãƒ³ãƒ‰ã®å‡¦ç†
        if user_message == "myid":
            line_bot_api.reply_message(
                event.reply_token,
                TextSendMessage(text=f"ã‚ãªãŸã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ID: {user_id}")
            )
            logger.info("Sent myid response")
            return

        # ãƒ–ãƒ­ãƒƒã‚¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒã‚§ãƒƒã‚¯
        if user_id in BLOCKED_USERS:
            line_bot_api.reply_message(
                event.reply_token,
                TextSendMessage(text="ç”³ã—è¨³ã‚ã‚Šã¾ã›ã‚“ã€‚ã“ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¯ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã›ã‚“ã€‚")
            )
            logger.info("Blocked user attempted access")
            return
            
        # è¨±å¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒã‚§ãƒƒã‚¯
        if len(ALLOWED_USERS) > 0 and user_id not in ALLOWED_USERS:
            line_bot_api.reply_message(
                event.reply_token,
                TextSendMessage(text="ã‚µãƒ¼ãƒ“ã‚¹ã‚’åˆ©ç”¨ã™ã‚‹ã«ã¯ã€ã¾ãš 'myid' ã¨é€ä¿¡ã—ã¦IDã‚’ç¢ºèªã—ã€Xï¼ˆæ—§Twitterï¼‰ã®DMã«ã¦IDã‚’ä¼ãˆã¦ãã ã•ã„âœ¨")
            )
            logger.info("Unauthorized user attempted access")
            return

        # ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ç”Ÿæˆ
        messages = sakuragi.get_appropriate_response(user_id, user_message)
        line_bot_api.reply_message(event.reply_token, messages)
        logger.info(f"Sent response: {messages}")

    except Exception as e:
        logger.error(f"Error in handle_message: {str(e)}", exc_info=True)
        error_response = sakuragi.handle_error(e)
        line_bot_api.reply_message(
            event.reply_token,
            TextSendMessage(text=error_response)
        )


if __name__ == "__main__":
    port = int(os.getenv("PORT", 8080))
    app.run(host="0.0.0.0", port=port)
